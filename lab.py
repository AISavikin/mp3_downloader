import PySimpleGUI as sg
import requests
from bs4 import BeautifulSoup
from fake_useragent import UserAgent
import vlc
from utils import Track, FuzzyTrack, get_html, log, musify, mp3bob, drivemusic
from requests.exceptions import SSLError, MissingSchema
import os
import time
from pathlib import Path


def check(track):
    file_name = f'MP3/{track.author} - {track.title}.mp3'
    if os.path.exists(file_name):
        return True

def time_it(func):
    def wrapper(*args):
        start_time = time.time()
        func(args)
        end_time = round(float(time.time() - start_time))
        log.info(f'{func.__name__} {end_time}')
    return wrapper
@time_it
@log.catch
def musify(track: Track):
    if track.url:
        return
    url = 'https://w1.musify.club/search'
    params = {
        'searchText': f'{track.author} {track.title}',
    }
    html = get_html(url, params)
    if not html:
        return
    soup = BeautifulSoup(html.text, features='html.parser')
    results = soup.find_all('div', class_='playlist__item')[:2]
    if not results:
        log.error(f'{track.author} - {track.title} : Не найдено')
        return
    for result in results:
        author = result.find_all('a')[0].text
        title = result.find_all('a')[1].text
        url = 'https://musify.club' + result.find_all('a')[2].get('href')
        if track.author.lower() in author.lower() and track.title.lower() in title.lower():
            track.title = title
            track.author = author
            track.url = url
            log.info(f'{track.author} - {track.title} : Точное совпадение')
            break
        else:
            log.debug(f'{track.author} - {track.title} : Не точное совпадение')
        track.fuzzy_matches.append(FuzzyTrack(author, title, url=url))

test_tracks = [Track(author='Marie Laforêt', title='Ivan, Boris et moi', url='', fuzzy_matches=[]), Track(author='Павел Пиковский', title='Меняй', url='https://musify.club/track/dl/9191886/%d0%bf%d0%b0%d0%b2%d0%b5%d0%bb-%d0%bf%d0%b8%d0%ba%d0%be%d0%b2%d1%81%d0%ba%d0%b8%d0%b8-%d0%bc%d0%b5%d0%bd%d1%8f%d0%b8.mp3', fuzzy_matches=[]), Track(author='ЕстьЧО', title='Танки', url='', fuzzy_matches=[]), Track(author='#дископровокация', title='Кавказское Диско', url='', fuzzy_matches=[FuzzyTrack(author='Дископровокация', title='Виталька', url='https://musify.club/track/dl/7048668/%d0%b4%d0%b8%d1%81%d0%ba%d0%be%d0%bf%d1%80%d0%be%d0%b2%d0%be%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-%d0%b2%d0%b8%d1%82%d0%b0%d0%bb%d1%8c%d0%ba%d0%b0.mp3'), FuzzyTrack(author='Дископровокация', title='Дальнобойщица', url='https://musify.club/track/dl/7048674/%d0%b4%d0%b8%d1%81%d0%ba%d0%be%d0%bf%d1%80%d0%be%d0%b2%d0%be%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-%d0%b4%d0%b0%d0%bb%d1%8c%d0%bd%d0%be%d0%b1%d0%be%d0%b8%d1%89%d0%b8%d1%86%d0%b0.mp3')]), Track(author='The Dirty Heads', title='Vacation', url='https://musify.club/track/dl/8509906/the-dirty-heads-vacation.mp3', fuzzy_matches=[]), Track(author='One-T', title='The Magic Key', url='https://cdn.drivemusic.me/dl/online/hLZTig1cPA8elRcX5hMrug/1665188442/download_music/2014/02/one-t-amp-cool-t-the-magic-key.mp3', fuzzy_matches=[FuzzyTrack(author='21ST Century Beatnik', title='One T', url='https://musify.club/track/dl/85699/21st-century-beatnik-one-t.mp3'), FuzzyTrack(author='Cool T', title='One T', url='https://musify.club/track/cool-t-one-t-the-magic-key-denim-fox-future-remix-12791523')]), Track(author='Hugo [USA]', title='99 Problems', url='https://musify.club/track/dl/1689751/hugo-usa-99-problems.mp3', fuzzy_matches=[]), Track(author='Tones And I', title='Dance Monkey', url='https://musify.club/track/dl/11795657/tones-and-i-dance-monkey.mp3', fuzzy_matches=[]), Track(author='Екатерина Яшникова', title='Песня о себе', url='', fuzzy_matches=[FuzzyTrack(author='Екатерина Яшникова', title='О Недописанных Песнях', url='https://musify.club/track/dl/17936611/%d0%b5%d0%ba%d0%b0%d1%82%d0%b5%d1%80%d0%b8%d0%bd%d0%b0-%d1%8f%d1%88%d0%bd%d0%b8%d0%ba%d0%be%d0%b2%d0%b0-%d0%be-%d0%bd%d0%b5%d0%b4%d0%be%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%bd%d1%8b%d1%85-%d0%bf%d0%b5%d1%81%d0%bd%d1%8f%d1%85.mp3')]), Track(author='Кошки Jam', title='Солнце (Купи мне гитару)', url='', fuzzy_matches=[FuzzyTrack(author='Feel Well', title='Солнце Купи Мне Гитару', url='https://musify.club/track/dl/2805638/feel-well-%d1%81%d0%be%d0%bb%d0%bd%d1%86%d0%b5-%d0%ba%d1%83%d0%bf%d0%b8-%d0%bc%d0%bd%d0%b5-%d0%b3%d0%b8%d1%82%d0%b0%d1%80%d1%83.mp3')]), Track(author='Четыре сыра', title='32', url='https://musify.club/track/dl/17591352/%d1%87%d0%b5%d1%82%d1%8b%d1%80%d0%b5-%d1%81%d1%8b%d1%80%d0%b0-32.mp3', fuzzy_matches=[]), Track(author='Don McLean', title='Don Mclean - American Pie', url='https://musify.club/track/dl/18437894/don-mclean-don-mclean-american-pie.mp3', fuzzy_matches=[]), Track(author='Паша Руденко', title='Ебш', url='', fuzzy_matches=[FuzzyTrack(author='Паша Руденко', title='Пятница', url='https://musify.club/track/dl/13737391/%d0%bf%d0%b0%d1%88%d0%b0-%d1%80%d1%83%d0%b4%d0%b5%d0%bd%d0%ba%d0%be-%d0%bf%d1%8f%d1%82%d0%bd%d0%b8%d1%86%d0%b0.mp3'), FuzzyTrack(author='Паша Руденко', title='Немой', url='https://musify.club/track/dl/10640390/%d0%bf%d0%b0%d1%88%d0%b0-%d1%80%d1%83%d0%b4%d0%b5%d0%bd%d0%ba%d0%be-%d0%bd%d0%b5%d0%bc%d0%be%d0%b8.mp3')]), Track(author='Metallica', title='Nothing Else Matters (Demo)', url='https://musify.club/track/dl/3071685/metallica-nothing-else-matters-demo.mp3', fuzzy_matches=[FuzzyTrack(author='Silenzium', title='Nothing Else Matters (Metallica)', url='https://musify.club/track/dl/3321400/silenzium-nothing-else-matters-metallica.mp3')]), Track(author='Пневмослон', title='Ебашу как в последний раз', url='', fuzzy_matches=[FuzzyTrack(author='Пневмослон', title='Ебашу, Как В Последний Раз', url='https://musify.club/track/dl/9303415/%d0%bf%d0%bd%d0%b5%d0%b2%d0%bc%d0%be%d1%81%d0%bb%d0%be%d0%bd-%d0%b5%d0%b1%d0%b0%d1%88%d1%83-%d0%ba%d0%b0%d0%ba-%d0%b2-%d0%bf%d0%be%d1%81%d0%bb%d0%b5%d0%b4%d0%bd%d0%b8%d0%b8-%d1%80%d0%b0%d0%b7.mp3'), FuzzyTrack(author='Порнофильмы', title='Как в последний раз', url='https://musify.club/track/dl/6934317/%d0%bf%d0%be%d1%80%d0%bd%d0%be%d1%84%d0%b8%d0%bb%d1%8c%d0%bc%d1%8b-%d0%ba%d0%b0%d0%ba-%d0%b2-%d0%bf%d0%be%d1%81%d0%bb%d0%b5%d0%b4%d0%bd%d0%b8%d0%b8-%d1%80%d0%b0%d0%b7.mp3')]), Track(author='Захар Май', title='Нахуй!', url='https://musify.club/track/dl/1421811/%d0%b7%d0%b0%d1%85%d0%b0%d1%80-%d0%bc%d0%b0%d0%b8-%d0%bd%d0%b0%d1%85%d1%83%d0%b8.mp3', fuzzy_matches=[]), Track(author='Зимовье Зверей', title='Джин И Тоник', url='https://musify.club/track/dl/3245629/%d0%b7%d0%b8%d0%bc%d0%be%d0%b2%d1%8c%d0%b5-%d0%b7%d0%b2%d0%b5%d1%80%d0%b5%d0%b8-%d0%b4%d0%b6%d0%b8%d0%bd-%d0%b8-%d1%82%d0%be%d0%bd%d0%b8%d0%ba.mp3', fuzzy_matches=[]), Track(author='Драгни', title='Не парься!', url='', fuzzy_matches=[FuzzyTrack(author='Башаков', title='Не Парься', url='https://musify.club/track/dl/3415278/%d0%b1%d0%b0%d1%88%d0%b0%d0%ba%d0%be%d0%b2-%d0%bd%d0%b5-%d0%bf%d0%b0%d1%80%d1%8c%d1%81%d1%8f.mp3'), FuzzyTrack(author='Механизм', title='Не Парься!', url='https://musify.club/track/dl/7247954/%d0%bc%d0%b5%d1%85%d0%b0%d0%bd%d0%b8%d0%b7%d0%bc-%d0%bd%d0%b5-%d0%bf%d0%b0%d1%80%d1%8c%d1%81%d1%8f.mp3')]), Track(author='Princesse Angine', title='Фантастический Вальс', url='https://musify.club/track/dl/15045185/princesse-angine-%d1%84%d0%b0%d0%bd%d1%82%d0%b0%d1%81%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%b8%d0%b8-%d0%b2%d0%b0%d0%bb%d1%8c%d1%81.mp3', fuzzy_matches=[]), Track(author='Nodahsa', title='Я Никогда Не Стану Феминисткой', url='https://cdn.drivemusic.me/dl/online/DL2tvbNFYxZZWLToTS6_qw/1665188458/download_music/2021/04/nodahsa-ja-nikogda-ne-stanu-feministkojj.mp3', fuzzy_matches=[]), Track(author='GALAGA', title='Супер Марио', url='', fuzzy_matches=[FuzzyTrack(author='Радиоактивный Покемон', title='Супер Марио (rock version)', url='https://musify.club/track/dl/16186313/%d1%80%d0%b0%d0%b4%d0%b8%d0%be%d0%b0%d0%ba%d1%82%d0%b8%d0%b2%d0%bd%d1%8b%d0%b8-%d0%bf%d0%be%d0%ba%d0%b5%d0%bc%d0%be%d0%bd-%d1%81%d1%83%d0%bf%d0%b5%d1%80-%d0%bc%d0%b0%d1%80%d0%b8%d0%be-rock-version.mp3'), FuzzyTrack(author='Марион', title='Супермаркет', url='https://musify.club/track/dl/5128590/%d0%bc%d0%b0%d1%80%d0%b8%d0%be%d0%bd-%d1%81%d1%83%d0%bf%d0%b5%d1%80%d0%bc%d0%b0%d1%80%d0%ba%d0%b5%d1%82.mp3')]), Track(author='БоБРы', title='Бальник', url='', fuzzy_matches=[]), Track(author='ANAZED', title='И я', url='', fuzzy_matches=[FuzzyTrack(author='Лариса Черникова', title='И ты и я, и я и ты', url='https://musify.club/track/dl/1532653/%d0%bb%d0%b0%d1%80%d0%b8%d1%81%d0%b0-%d1%87%d0%b5%d1%80%d0%bd%d0%b8%d0%ba%d0%be%d0%b2%d0%b0-%d0%b8-%d1%82%d1%8b-%d0%b8-%d1%8f-%d0%b8-%d1%8f-%d0%b8-%d1%82%d1%8b.mp3'), FuzzyTrack(author='Умка', title='Я И Я', url='https://musify.club/track/dl/11262259/%d1%83%d0%bc%d0%ba%d0%b0-%d1%8f-%d0%b8-%d1%8f.mp3')]), Track(author='XXX $ Горы', title='Барышни', url='', fuzzy_matches=[]), Track(author='Don McLean', title='Don Mclean - American Pie', url='https://musify.club/track/dl/18437894/don-mclean-don-mclean-american-pie.mp3', fuzzy_matches=[]), Track(author='Princesse Angine', title='Не Потянешь', url='https://musify.club/track/dl/9522870/princesse-angine-%d0%bd%d0%b5-%d0%bf%d0%be%d1%82%d1%8f%d0%bd%d0%b5%d1%88%d1%8c.mp3', fuzzy_matches=[]), Track(author='Tardigrade Inferno', title='We Are Number One (Lazy Town cover)', url='https://musify.club/track/dl/10492993/tardigrade-inferno-we-are-number-one-lazy-town-cover.mp3', fuzzy_matches=[]), Track(author='The Kills', title='Doing It To Death', url='https://musify.club/track/dl/6256721/the-kills-doing-it-to-death.mp3', fuzzy_matches=[]), Track(author='Odnono', title='Спасибо', url='', fuzzy_matches=[]), Track(author='Moon Hooch', title='Acid Mountain', url='', fuzzy_matches=[FuzzyTrack(author='Moon Hooch', title='Mountain Lion', url='https://musify.club/track/dl/7318094/moon-hooch-mountain-lion.mp3'), FuzzyTrack(author='Moon Hooch', title='Mountain Song', url='https://musify.club/track/dl/5914894/moon-hooch-mountain-song.mp3')]), Track(author='Антитіла', title='Бери Своє', url='https://musify.club/track/dl/1895231/%d0%b0%d0%bd%d1%82%d0%b8%d1%82i%d0%bb%d0%b0-%d0%b1%d0%b5%d1%80%d0%b8-%d1%81%d0%b2%d0%bee.mp3', fuzzy_matches=[]), Track(author='Coockoo', title="I Can't Remember", url='https://musify.club/track/dl/6849707/coockoo-i-cant-remember.mp3', fuzzy_matches=[]), Track(author='Le Tigre', title='Deceptacon', url='https://musify.club/track/dl/684537/le-tigre-deceptacon.mp3', fuzzy_matches=[]), Track(author='Cut Chemist', title="What's The Altitude", url='https://musify.club/track/dl/2515228/cut-chemist-whats-the-altitude.mp3', fuzzy_matches=[]), Track(author='Заточка', title='В Тюрьму Нельзя Feat. Артур Беркут', url='https://musify.club/track/dl/17197714/%d0%b7%d0%b0%d1%82%d0%be%d1%87%d0%ba%d0%b0-%d0%b2-%d1%82%d1%8e%d1%80%d1%8c%d0%bc%d1%83-%d0%bd%d0%b5%d0%bb%d1%8c%d0%b7%d1%8f-feat-%d0%b0%d1%80%d1%82%d1%83%d1%80-%d0%b1%d0%b5%d1%80%d0%ba%d1%83%d1%82.mp3', fuzzy_matches=[]), Track(author='Карандаш', title='Hellp', url='', fuzzy_matches=[]), Track(author='Noize MC', title='Катацумури', url='', fuzzy_matches=[]), Track(author='Птицу ЕМЪ', title='Крысоловы', url='https://musify.club/track/dl/4587135/%d0%bf%d1%82%d0%b8%d1%86%d1%83-%d0%b5%d0%bc%d1%8a-%d0%ba%d1%80%d1%8b%d1%81%d0%be%d0%bb%d0%be%d0%b2%d1%8b.mp3', fuzzy_matches=[]), Track(author='Ундервуд', title='Лавацца', url='', fuzzy_matches=[]), Track(author='Reignwolf', title='Keeper', url='https://musify.club/track/dl/10597535/reignwolf-keeper.mp3', fuzzy_matches=[]), Track(author='Haley Reinhart', title='Creep', url='', fuzzy_matches=[FuzzyTrack(author="Scott Bradlee's Postmodern Jukebox", title='Creep (Feat. Haley Reinhart)', url='https://musify.club/track/dl/5577350/scott-bradlees-postmodern-jukebox-creep-feat-haley-reinhart.mp3'), FuzzyTrack(author='Haley Reinhart', title='Better', url='https://musify.club/track/dl/6327279/haley-reinhart-better.mp3')]), Track(author='Oxxxymiron', title='Организация', url='https://musify.club/track/dl/17329482/oxxxymiron-%d0%be%d1%80%d0%b3%d0%b0%d0%bd%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f.mp3', fuzzy_matches=[]), Track(author='White Punk', title='Трансгуманизм', url='', fuzzy_matches=[FuzzyTrack(author='White Punk', title='Вампиръ (Produced By White Punk)', url='https://musify.club/track/dl/10876671/white-punk-%d0%b2%d0%b0%d0%bc%d0%bf%d0%b8%d1%80%d1%8a-produced-by-white-punk.mp3'), FuzzyTrack(author='White Punk', title='Мёртв Внутри (Produced By White Punk)', url='https://musify.club/track/dl/10876672/white-punk-%d0%bc%d0%b5%d1%80%d1%82%d0%b2-%d0%b2%d0%bd%d1%83%d1%82%d1%80%d0%b8-produced-by-white-punk.mp3')]), Track(author='Imagine Dragons', title='Enemy (OST Arcane League Of Legends)', url='https://cdn.drivemusic.me/dl/online/cbKdEjdz1Xxn7S4Dj6ZiXA/1665188487/download_music/2021/10/imagine-dragons-feat.-jid-league-of-legends-enemy-ost-arcane-league-of-legends.mp3', fuzzy_matches=[FuzzyTrack(author='Emerald Isle', title='Enemy (Imagine Dragons & JID Cover)', url='https://musify.club/track/dl/17782425/emerald-isle-enemy-imagine-dragons-and-jid-cover.mp3'), FuzzyTrack(author='Leo Moracchioli', title='Enemy (Imagine Dragons Cover) (Metal Version)', url='https://musify.club/track/dl/18244033/leo-moracchioli-enemy-imagine-dragons-cover-metal-version.mp3')]), Track(author='Немного Нервно', title='Жена Смотрителя Маяка', url='https://musify.club/track/dl/9605386/%d0%bd%d0%b5%d0%bc%d0%bd%d0%be%d0%b3%d0%be-%d0%bd%d0%b5%d1%80%d0%b2%d0%bd%d0%be-%d0%b6%d0%b5%d0%bd%d0%b0-%d1%81%d0%bc%d0%be%d1%82%d1%80%d0%b8%d1%82%d0%b5%d0%bb%d1%8f-%d0%bc%d0%b0%d1%8f%d0%ba%d0%b0.mp3', fuzzy_matches=[]), Track(author='Порнофильмы', title='Дядя Володя', url='https://musify.club/track/dl/12538780/%d0%bf%d0%be%d1%80%d0%bd%d0%be%d1%84%d0%b8%d0%bb%d1%8c%d0%bc%d1%8b-%d0%b4%d1%8f%d0%b4%d1%8f-%d0%b2%d0%be%d0%bb%d0%be%d0%b4%d1%8f.mp3', fuzzy_matches=[]), Track(author='Порнофильмы', title='Это Пройдёт', url='https://musify.club/track/dl/12538779/%d0%bf%d0%be%d1%80%d0%bd%d0%be%d1%84%d0%b8%d0%bb%d1%8c%d0%bc%d1%8b-%d1%8d%d1%82%d0%be-%d0%bf%d1%80%d0%be%d0%b8%d0%b4%d0%b5%d1%82.mp3', fuzzy_matches=[]), Track(author='Второй Ка', title='39 школа', url='', fuzzy_matches=[]), Track(author='Zero 7', title='In The Waiting Line', url='https://musify.club/track/dl/527994/zero-7-in-the-waiting-line.mp3', fuzzy_matches=[]), Track(author='Scott Bradlee’s Postmodern Jukebox', title="Don't Speak", url='', fuzzy_matches=[FuzzyTrack(author="Scott Bradlee's Postmodern Jukebox", title="I Don't Mind", url='https://musify.club/track/dl/5631081/scott-bradlees-postmodern-jukebox-i-dont-mind.mp3'), FuzzyTrack(author="Scott Bradlee's Postmodern Jukebox", title="Don't Stop (Live)", url='https://musify.club/track/dl/8692995/scott-bradlees-postmodern-jukebox-dont-stop-live.mp3')]), Track(author='Заточка', title='Держи В Курсе', url='https://musify.club/track/dl/17197707/%d0%b7%d0%b0%d1%82%d0%be%d1%87%d0%ba%d0%b0-%d0%b4%d0%b5%d1%80%d0%b6%d0%b8-%d0%b2-%d0%ba%d1%83%d1%80%d1%81%d0%b5.mp3', fuzzy_matches=[]), Track(author='Reignwolf', title='Over & Over', url='https://musify.club/track/dl/10597532/reignwolf-over-and-over.mp3', fuzzy_matches=[]), Track(author='Princesse Angine', title='Старше', url='https://musify.club/track/dl/13767734/princesse-angine-%d1%81%d1%82%d0%b0%d1%80%d1%88%d0%b5.mp3', fuzzy_matches=[]), Track(author='Немного Нервно', title='Ричард', url='https://musify.club/track/dl/6838923/%d0%bd%d0%b5%d0%bc%d0%bd%d0%be%d0%b3%d0%be-%d0%bd%d0%b5%d1%80%d0%b2%d0%bd%d0%be-%d1%80%d0%b8%d1%87%d0%b0%d1%80%d0%b4.mp3', fuzzy_matches=[]), Track(author='New Tribute Kings', title='Love Is All Around Originally Performed By Wet Wet Wet', url='', fuzzy_matches=[]), Track(author='Кровосток', title='Цветы в вазе', url='https://musify.club/track/dl/2323504/%d0%ba%d1%80%d0%be%d0%b2%d0%be%d1%81%d1%82%d0%be%d0%ba-%d1%86%d0%b2%d0%b5%d1%82%d1%8b-%d0%b2-%d0%b2%d0%b0%d0%b7%d0%b5.mp3', fuzzy_matches=[]), Track(author='Lesley Gore', title="You Don't Own Me", url='', fuzzy_matches=[FuzzyTrack(author='Ann Wilson', title="You Don't Own Me (Lesley Gore)", url='https://musify.club/track/dl/9916639/ann-wilson-you-dont-own-me-lesley-gore.mp3'), FuzzyTrack(author='Eminem', title="Lesley Gore - You Don't Own Me (Untitled)", url='https://musify.club/track/dl/955833/eminem-lesley-gore-you-dont-own-me-untitled.mp3')]), Track(author='The Tiger Lillies', title='Heroin', url='https://musify.club/track/dl/1678406/the-tiger-lillies-heroin.mp3', fuzzy_matches=[]), Track(author='АИГЕЛ', title='Тебе кажется', url='', fuzzy_matches=[FuzzyTrack(author='Мимо Вселенной', title='Тебе Кажется', url='https://musify.club/track/dl/8200410/%d0%bc%d0%b8%d0%bc%d0%be-%d0%b2%d1%81%d0%b5%d0%bb%d0%b5%d0%bd%d0%bd%d0%be%d0%b8-%d1%82%d0%b5%d0%b1%d0%b5-%d0%ba%d0%b0%d0%b6%d0%b5%d1%82%d1%81%d1%8f.mp3'), FuzzyTrack(author='Фристайл', title='Это все тебе кажется', url='https://musify.club/track/dl/5149442/%d1%84%d1%80%d0%b8%d1%81%d1%82%d0%b0%d0%b8%d0%bb-%d1%8d%d1%82%d0%be-%d0%b2%d1%81%d0%b5-%d1%82%d0%b5%d0%b1%d0%b5-%d0%ba%d0%b0%d0%b6%d0%b5%d1%82%d1%81%d1%8f.mp3')]), Track(author='Зоопарк', title='Я Продолжаю Забывать', url='https://musify.club/track/dl/2279721/%d0%b7%d0%be%d0%be%d0%bf%d0%b0%d1%80%d0%ba-%d1%8f-%d0%bf%d1%80%d0%be%d0%b4%d0%be%d0%bb%d0%b6%d0%b0%d1%8e-%d0%b7%d0%b0%d0%b1%d1%8b%d0%b2%d0%b0%d1%82%d1%8c.mp3', fuzzy_matches=[]), Track(author='M83', title='Midnight City', url='https://musify.club/track/dl/1916879/m83-midnight-city.mp3', fuzzy_matches=[]), Track(author='The Pierces', title='We Are Stars', url='https://musify.club/track/dl/1525152/the-pierces-we-are-stars.mp3', fuzzy_matches=[]), Track(author='The Dead South', title="In Hell I'll Be In Good Company", url='https://musify.club/track/dl/5578125/the-dead-south-in-hell-ill-be-in-good-company.mp3', fuzzy_matches=[]), Track(author='Lesley Gore', title="Lesley Gore - It's My Party", url='https://musify.club/track/dl/18437762/lesley-gore-lesley-gore-its-my-party.mp3', fuzzy_matches=[]), Track(author='Redbone', title='Come And Get Your Love', url='https://musify.club/track/dl/4487762/redbone-come-and-get-your-love.mp3', fuzzy_matches=[]), Track(author='Алоэвера', title='Ты Что Такой?', url='https://musify.club/track/dl/6931345/%d0%b0%d0%bb%d0%be%d1%8d%d0%b2%d0%b5%d1%80%d0%b0-%d1%82%d1%8b-%d1%87%d1%82%d0%be-%d1%82%d0%b0%d0%ba%d0%be%d0%b8.mp3', fuzzy_matches=[]), Track(author='Princesse Angine', title='Выходи В Сад', url='https://musify.club/track/dl/9522865/princesse-angine-%d0%b2%d1%8b%d1%85%d0%be%d0%b4%d0%b8-%d0%b2-%d1%81%d0%b0%d0%b4.mp3', fuzzy_matches=[]), Track(author='Немного Нервно', title='Черное Озеро', url='https://musify.club/track/dl/16649626/%d0%bd%d0%b5%d0%bc%d0%bd%d0%be%d0%b3%d0%be-%d0%bd%d0%b5%d1%80%d0%b2%d0%bd%d0%be-%d1%87%d0%b5%d1%80%d0%bd%d0%be%d0%b5-%d0%be%d0%b7%d0%b5%d1%80%d0%be.mp3', fuzzy_matches=[]), Track(author='Тропы не врут', title='Фея', url='', fuzzy_matches=[FuzzyTrack(author='Тропы Не Врут', title='Ненадолго', url='https://musify.club/track/dl/5770358/%d1%82%d1%80%d0%be%d0%bf%d1%8b-%d0%bd%d0%b5-%d0%b2%d1%80%d1%83%d1%82-%d0%bd%d0%b5%d0%bd%d0%b0%d0%b4%d0%be%d0%bb%d0%b3%d0%be.mp3'), FuzzyTrack(author='Тропы Не Врут', title='Ассоль', url='https://musify.club/track/dl/6236071/%d1%82%d1%80%d0%be%d0%bf%d1%8b-%d0%bd%d0%b5-%d0%b2%d1%80%d1%83%d1%82-%d0%b0%d1%81%d1%81%d0%be%d0%bb%d1%8c.mp3')]), Track(author='Gorillaz', title='The Lost Chord (feat. Leee John)', url='https://musify.club/track/dl/15421487/gorillaz-the-lost-chord-feat-leee-john.mp3', fuzzy_matches=[]), Track(author='Ram Jam', title='Black Betty', url='https://musify.club/track/dl/33757/ram-jam-black-betty.mp3', fuzzy_matches=[]), Track(author='Лорд Пневмослон', title='В пизду', url='', fuzzy_matches=[FuzzyTrack(author='Пневмослон', title='В Пизду', url='https://musify.club/track/dl/9303416/%d0%bf%d0%bd%d0%b5%d0%b2%d0%bc%d0%be%d1%81%d0%bb%d0%be%d0%bd-%d0%b2-%d0%bf%d0%b8%d0%b7%d0%b4%d1%83.mp3'), FuzzyTrack(author='Саблезубый Тигр', title='Насилие В Семье (Лорд Пневмослон Cover)', url='https://musify.club/track/dl/9632063/%d1%81%d0%b0%d0%b1%d0%bb%d0%b5%d0%b7%d1%83%d0%b1%d1%8b%d0%b8-%d1%82%d0%b8%d0%b3%d1%80-%d0%bd%d0%b0%d1%81%d0%b8%d0%bb%d0%b8%d0%b5-%d0%b2-%d1%81%d0%b5%d0%bc%d1%8c%d0%b5-%d0%bb%d0%be%d1%80%d0%b4-%d0%bf%d0%bd%d0%b5%d0%b2%d0%bc%d0%be%d1%81%d0%bb%d0%be%d0%bd-cover.mp3')]), Track(author='Крематорий', title='Клубника со льдом', url='', fuzzy_matches=[]), Track(author='Пётр Налич', title='Сахарный пакет', url='', fuzzy_matches=[]), Track(author='Пётр Налич', title='One Solodo Whiskey', url='', fuzzy_matches=[]), Track(author='Птицу ЕМЪ', title='Старая Подруга (При Уч. Наталья Герулайтис)', url='https://musify.club/track/dl/3414556/%d0%bf%d1%82%d0%b8%d1%86%d1%83-%d0%b5%d0%bc%d1%8a-%d1%81%d1%82%d0%b0%d1%80%d0%b0%d1%8f-%d0%bf%d0%be%d0%b4%d1%80%d1%83%d0%b3%d0%b0-%d0%bf%d1%80%d0%b8-%d1%83%d1%87-%d0%bd%d0%b0%d1%82%d0%b0%d0%bb%d1%8c%d1%8f-%d0%b3%d0%b5%d1%80%d1%83%d0%bb%d0%b0%d0%b8%d1%82%d0%b8%d1%81.mp3', fuzzy_matches=[]), Track(author='Jacques Brel', title='Amsterdam', url='https://musify.club/track/dl/2607341/jacques-brel-amsterdam.mp3', fuzzy_matches=[]), Track(author='НОМ', title='Подшиток', url='https://musify.club/track/dl/2014421/%d0%bd%d0%be%d0%bc-%d0%bf%d0%be%d0%b4%d1%88%d0%b8%d1%82%d0%be%d0%ba.mp3', fuzzy_matches=[]), Track(author='НОМ', title='Вкус Алкоголя', url='https://musify.club/track/dl/4715804/%d0%bd%d0%be%d0%bc-%d0%b2%d0%ba%d1%83%d1%81-%d0%b0%d0%bb%d0%ba%d0%be%d0%b3%d0%be%d0%bb%d1%8f.mp3', fuzzy_matches=[]), Track(author='Гражданская Оборона', title='Иван Говнов', url='https://musify.club/track/dl/1606494/%d0%b3%d1%80%d0%b0%d0%b6%d0%b4%d0%b0%d0%bd%d1%81%d0%ba%d0%b0%d1%8f-%d0%be%d0%b1%d0%be%d1%80%d0%be%d0%bd%d0%b0-%d0%b8%d0%b2%d0%b0%d0%bd-%d0%b3%d0%be%d0%b2%d0%bd%d0%be%d0%b2.mp3', fuzzy_matches=[]), Track(author='Dr. Dre', title='The Next Episode (feat. Snoop Dogg)', url='https://musify.club/track/dl/5022878/dr-dre-the-next-episode-feat-snoop-dogg.mp3', fuzzy_matches=[FuzzyTrack(author='Snoop Dogg', title='Dr. Dre', url='https://musify.club/track/snoop-dogg-dr-dre-next-episode-10573679')]), Track(author='Jahmal TGK', title='Маятник', url='', fuzzy_matches=[FuzzyTrack(author='Big Mic [TGK]', title='Сегодня feat. Jahmal TGK', url='https://musify.club/track/dl/5294494/big-mic-tgk-%d1%81%d0%b5%d0%b3%d0%be%d0%b4%d0%bd%d1%8f-feat-jahmal-tgk.mp3'), FuzzyTrack(author='Jahmal', title='Перезаряженный feat.VibeTGK (music by: DjPu3aTGK, Jahmal[TGK])', url='https://musify.club/track/dl/7034602/jahmal-%d0%bf%d0%b5%d1%80%d0%b5%d0%b7%d0%b0%d1%80%d1%8f%d0%b6%d0%b5%d0%bd%d0%bd%d1%8b%d0%b8-feat-vibetgk-music-by-djpu3atgk-jahmal-tgk.mp3')]), Track(author='Аквариум', title='Электрический Пёс', url='https://musify.club/track/dl/1815724/%d0%b0%d0%ba%d0%b2%d0%b0%d1%80%d0%b8%d1%83%d0%bc-%d1%8d%d0%bb%d0%b5%d0%ba%d1%82%d1%80%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%b8%d0%b8-%d0%bf%d0%b5%d1%81.mp3', fuzzy_matches=[]), Track(author='Света Бень', title='Прощай, Тур де Франс!', url='', fuzzy_matches=[FuzzyTrack(author='Бенька', title='Прощай, Тур Де Франс!', url='https://musify.club/track/dl/16037752/%d0%b1%d0%b5%d0%bd%d1%8c%d0%ba%d0%b0-%d0%bf%d1%80%d0%be%d1%89%d0%b0%d0%b8-%d1%82%d1%83%d1%80-%d0%b4%d0%b5-%d1%84%d1%80%d0%b0%d0%bd%d1%81.mp3')]), Track(author='Richard Cheese', title="Darth Vader's Theme (Live In DC)", url='https://musify.club/track/dl/2604189/richard-cheese-darth-vaders-theme-live-in-dc.mp3', fuzzy_matches=[]), Track(author='Polo & Pan', title='Jacquadi', url='', fuzzy_matches=[FuzzyTrack(author='Polo & Pan', title='Peter Pan', url='https://musify.club/track/dl/17464171/polo-and-pan-peter-pan.mp3'), FuzzyTrack(author='Polo & Pan', title='Canopée', url='https://musify.club/track/dl/7847756/polo-and-pan-canopee.mp3')]), Track(author='Blackalicious', title='Chemical Calisthenics.', url='https://musify.club/track/dl/94240/blackalicious-chemical-calisthenics.mp3', fuzzy_matches=[]), Track(author='Emily Wells', title='Becomes The Color', url='https://musify.club/track/dl/3063914/emily-wells-becomes-the-color.mp3', fuzzy_matches=[]), Track(author="Fool's Garden", title='Why Did She Go ?', url='', fuzzy_matches=[FuzzyTrack(author="Fool's Garden", title='Why Did She Go?', url='https://musify.club/track/dl/540890/fools-garden-why-did-she-go.mp3'), FuzzyTrack(author='Blues Underground', title='Why Did She Go?', url='https://musify.club/track/dl/6302466/blues-underground-why-did-she-go.mp3')]), Track(author='Mando Diao', title='Good Times', url='https://musify.club/track/dl/7815725/mando-diao-good-times.mp3', fuzzy_matches=[]), Track(author='Podval Capella', title='Cocaine', url='https://musify.club/track/dl/5683564/podval-capella-cocaine.mp3', fuzzy_matches=[]), Track(author='Кровосток', title='Куртец', url='https://musify.club/track/dl/2323496/%d0%ba%d1%80%d0%be%d0%b2%d0%be%d1%81%d1%82%d0%be%d0%ba-%d0%ba%d1%83%d1%80%d1%82%d0%b5%d1%86.mp3', fuzzy_matches=[]), Track(author='Монеточка', title='Кумушки', url='https://musify.club/track/dl/9447905/%d0%bc%d0%be%d0%bd%d0%b5%d1%82%d0%be%d1%87%d0%ba%d0%b0-%d0%ba%d1%83%d0%bc%d1%83%d1%88%d0%ba%d0%b8.mp3', fuzzy_matches=[]), Track(author='Монеточка', title='Русский ковчег', url='https://musify.club/track/dl/9447900/%d0%bc%d0%be%d0%bd%d0%b5%d1%82%d0%be%d1%87%d0%ba%d0%b0-%d1%80%d1%83%d1%81%d1%81%d0%ba%d0%b8%d0%b8-%d0%ba%d0%be%d0%b2%d1%87%d0%b5%d0%b3.mp3', fuzzy_matches=[]), Track(author='Монеточка', title='Нет монет', url='https://musify.club/track/dl/9447903/%d0%bc%d0%be%d0%bd%d0%b5%d1%82%d0%be%d1%87%d0%ba%d0%b0-%d0%bd%d0%b5%d1%82-%d0%bc%d0%be%d0%bd%d0%b5%d1%82.mp3', fuzzy_matches=[]), Track(author='Монеточка', title='Я Лиза', url='', fuzzy_matches=[FuzzyTrack(author='Монеточка', title='Я - Лиза', url='https://musify.club/track/dl/6037815/%d0%bc%d0%be%d0%bd%d0%b5%d1%82%d0%be%d1%87%d0%ba%d0%b0-%d1%8f-%d0%bb%d0%b8%d0%b7%d0%b0.mp3'), FuzzyTrack(author='Монеточка', title='Мама Я Не Зигую', url='https://musify.club/track/dl/10182135/%d0%bc%d0%be%d0%bd%d0%b5%d1%82%d0%be%d1%87%d0%ba%d0%b0-%d0%bc%d0%b0%d0%bc%d0%b0-%d1%8f-%d0%bd%d0%b5-%d0%b7%d0%b8%d0%b3%d1%83%d1%8e.mp3')]), Track(author='Монеточка', title='Пост-пост', url='https://musify.club/track/dl/9447909/%d0%bc%d0%be%d0%bd%d0%b5%d1%82%d0%be%d1%87%d0%ba%d0%b0-%d0%bf%d0%be%d1%81%d1%82-%d0%bf%d0%be%d1%81%d1%82.mp3', fuzzy_matches=[]), Track(author='Монеточка', title='Переживу', url='https://musify.club/track/dl/15276766/%d0%bc%d0%be%d0%bd%d0%b5%d1%82%d0%be%d1%87%d0%ba%d0%b0-%d0%bf%d0%b5%d1%80%d0%b5%d0%b6%d0%b8%d0%b2%d1%83.mp3', fuzzy_matches=[]), Track(author='Монеточка', title='Шприц', url='https://musify.club/track/dl/15276763/%d0%bc%d0%be%d0%bd%d0%b5%d1%82%d0%be%d1%87%d0%ba%d0%b0-%d1%88%d0%bf%d1%80%d0%b8%d1%86.mp3', fuzzy_matches=[]), Track(author='Монеточка', title='Тугие Косы', url='https://musify.club/track/dl/15276762/%d0%bc%d0%be%d0%bd%d0%b5%d1%82%d0%be%d1%87%d0%ba%d0%b0-%d1%82%d1%83%d0%b3%d0%b8%d0%b5-%d0%ba%d0%be%d1%81%d1%8b.mp3', fuzzy_matches=[])]
# for_download = [track for track in test_tracks if track.url]

def download(track):
    file_name = f'MP3/{track.author} - {track.title}.mp3'.replace('?', '')
    log.debug(f'{file_name=}')
    if os.path.exists(file_name):
        log.info(f'{file_name} Уже существует')
        return
    with open(file_name, 'wb') as f:
        log.debug(track.url)
        data = requests.get(track.url, headers={'User-Agent': UserAgent().random})
        log.debug(data)
        f.write(data.content)
tracks = [Track(author='Машина Времени', title='Костёр (Remastered 2019)', url='https://musify.club/track/dl/10944733/%d0%bc%d0%b0%d1%88%d0%b8%d0%bd%d0%b0-%d0%b2%d1%80%d0%b5%d0%bc%d0%b5%d0%bd%d0%b8-%d0%ba%d0%be%d1%81%d1%82%d0%b5%d1%80-remastered-2019.mp3', fuzzy_matches=[]), Track(author='Sak Noel', title='Loca People (What the F**k!")', url='', fuzzy_matches=[FuzzyTrack(author='Playlist Djs', title='Loca People (What The F**K!) [Cover Version]', url='https://musify.club/track/dl/15037654/playlist-djs-loca-people-what-the-f-k-cover-version.mp3'), FuzzyTrack(author='Bassboy', title='Yes (Here We Go) / Traktor (Mike Delinquent Project Go Harder Dub) [Feat. L] / Loca People (What The F**K!) [Acapella]', url='https://musify.club/track/dl/2465128/bassboy-yes-here-we-go-traktor-mike-delinquent-project-go-harder-dub-f.mp3')])]



# file_name = r'MP3bla?bla*bla<bla>bla:bla"bla\bla/bla|.mp3'.replace('?', '')
# for char in r'?*<>:"\/|':
#     file_name = file_name.replace(char, ' ')
# log.debug(file_name)
mp3 = [file for file in os.listdir() if file.endswith('mp3')]
print(mp3)
for file in mp3:
    os.rename(file, file[4:])